<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Order Complete</title>
	<link rel="icon" type="image/png" href="bealogo.png">
<link rel="stylesheet" href="style.css">
</head>

<body>

<nav class="navbar">
  <div class="nav-logo" onclick="window.location.href='index.html'" style="cursor:pointer;">BEA Canteen</div>
  <ul class="nav-links" style="list-style:none; display:flex; gap:15px; font-size:13px; align-items:center;">
    <li onclick="window.location.href='about.html'" style="cursor:pointer;">About</li>
    <li onclick="window.location.href='service.html'" style="cursor:pointer;">Services</li>
    <li onclick="window.location.href='help.html'" style="cursor:pointer;">Help</li>
    <li onclick="window.location.href='contact.html'" style="cursor:pointer;">Contact</li>
    <li onclick="window.location.href='dayselection.html'" style="cursor:pointer;">Change Day</li>
    <li onclick="window.location.href='reviewpage.html'" style="cursor:pointer;">Reviews</li>
  </ul>
  <div class="user-profile">
    <img src="speedpfp.jpg" class="profile-icon">
    <span id="display-name">Guest</span>
    <button onclick="logout()" class="logout-link">Logout</button>
  </div>
</nav>


<div class="container">

  <h2>Order Complete</h2>

  <p class="complete-text">
    Your order is complete.<br>
    Please claim your food at the canteen.
  </p>
  <div id="order-receipt" style="background: #fffdf5; padding: 15px; border: 1px solid #eee; border-radius: 8px; margin-bottom: 20px;">
  <h3 style="border-bottom: 2px solid #ff8c69; padding-bottom: 5px; margin-bottom: 10px;">Order Details</h3>
  <div id="receipt-items">
    </div>
  <div style="display: flex; justify-content: space-between; font-weight: bold; margin-top: 10px; font-size: 1.1em;">
    <span>TOTAL PAID:</span>
    <span id="receipt-total" style="color: #2c7a2c;">₱0.00</span>
  </div>
  <button onclick="window.print()" class="checkout-btn" style="background: #4A90E2; margin-bottom: 10px;">
  SAVE RECEIPT (PDF)
</button>
</div>

</div>
<div class="container" style="text-align: center; margin-top: 20px;">
  <h3>How was your food?</h3>
  <p style="font-size: 14px; color: #666; margin-bottom: 15px;">We'd love to hear your feedback!</p>
  
  <button onclick="window.location.href='reviewpage.html'" class="checkout-btn" style="background: #4A90E2;">
    REVIEW ORDER
  </button>
  
  <p style="margin-top: 20px;">
    <a href="index.html" style="color: #ff8c69; font-size: 14px;">Back to Menu</a>
  </p>
</div>

<script>
window.onload = function() {
    // 1. SECURE DATA RETRIEVAL
    const name = localStorage.getItem("studentName") || "Guest";
    const isLoggedIn = localStorage.getItem("isLoggedIn");
    const orderData = JSON.parse(localStorage.getItem("latestOrder")) || [];
    const totalData = localStorage.getItem("latestTotal") || "₱0.00";

    // 2. GATEKEEPER
    if (!isLoggedIn) {
        window.location.href = "login.html";
        return;
    }
    
    // 3. UPDATE UI
    document.getElementById("display-name").innerText = name;
    
    const receiptContainer = document.getElementById("receipt-items");
    const totalDisplay = document.getElementById("receipt-total");

    if (orderData.length > 0) {
        receiptContainer.innerHTML = ""; // Clear wait/placeholder
        orderData.forEach(item => {
            const p = document.createElement("p");
            p.className = "receipt-row";
            p.innerHTML = `<strong>${item.qty}x</strong> ${item.name} <span>${item.price}</span>`;
            receiptContainer.appendChild(p);
        });
        totalDisplay.innerText = totalData;
    } else {
        receiptContainer.innerHTML = "<p>No items found in current order.</p>";
    }
};

function logout() {
    localStorage.clear();
    window.location.href = "login.html";
}
</script>
</body>
<footer style="text-align: center; padding: 20px; opacity: 0.5;">
  <a href="admin.html" style="font-size: 10px; color: #666; text-decoration: none;">Admin Login</a>
</footer>
</html>