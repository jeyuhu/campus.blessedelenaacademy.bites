<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>School Canteen</title>
	<link rel="icon" type="image/png" href="bealogo.png">
  <link rel="stylesheet" href="style.css">
   <script src="https://unpkg.com/html5-qrcode"></script>
</head>
<body>

<nav class="navbar">
  <div class="nav-logo" onclick="window.location.href='index.html'" style="cursor:pointer;">BEA Canteen</div>
  <ul class="nav-links" style="list-style:none; display:flex; gap:15px; font-size:13px; align-items:center;">
    <li onclick="window.location.href='about.html'" style="cursor:pointer;">About</li>
    <li onclick="window.location.href='service.html'" style="cursor:pointer;">Services</li>
    <li onclick="window.location.href='help.html'" style="cursor:pointer;">Help</li>
    <li onclick="window.location.href='contact.html'" style="cursor:pointer;">Contact</li>
    <li onclick="window.location.href='dayselection.html'" style="cursor:pointer;">Change Day</li>
    <li onclick="window.location.href='reviewpage.html'" style="cursor:pointer;">Reviews</li>
  </ul>
  <div class="user-profile">
    <img src="speedpfp.jpg" class="profile-icon">
    <span id="display-name">Guest</span>
    <button onclick="logout()" class="logout-link">Logout</button>
  </div>
</nav>

<div class="container">
  <h2>Food Menu</h2>
  
  <div class="category-menu">
    <button type="button" class="cat-btn active" onclick="filterCategory('all', this)">All</button>
    <button type="button" class="cat-btn" onclick="filterCategory('meal', this)">Meals</button>
    <button type="button" class="cat-btn" onclick="filterCategory('drink', this)">Drinks</button>
    <button type="button" class="cat-btn" onclick="filterCategory('snack', this)">Snacks</button>
    <button type="button" class="cat-btn" onclick="filterCategory('candy', this)">Candies</button>
  </div>

  <form action="checkout.html">
  <div class="food-grid"> <div class="food-item" data-category="meal">
      <input type="checkbox" id="adobo">
      <img src="adobo.jpg" alt="Adobo">
      <label for="adobo">Adobo</label>
      <span class="price">₱40.00</span>
      <div class="qty-box">
        <label>Qty:</label>
        <select><option>1</option><option>2</option><option>3</option></select>
      </div>
    </div>

    <div class="food-item" data-category="meal">
      <input type="checkbox" id="friedchicken">
      <img src="friedchicken.jpg" alt="Chicken">
      <label for="friedchicken">Fried Chicken</label>
      <span class="price">₱30.00</span>
      <div class="qty-box">
        <label>Qty:</label>
        <select><option>1</option><option>2</option><option>3</option></select>
      </div>
    </div>

    <div class="food-item" data-category="meal">
      <input type="checkbox" id="rice">
      <img src="rice.jpg" alt="Rice">
      <label for="rice">Rice</label>
      <span class="price">₱15.00</span>
      <div class="qty-box">
        <label>Qty:</label>
        <select><option>1</option><option>2</option><option>3</option></select>
      </div>
    </div>

<div class="food-item" data-category="meal">
      <input type="checkbox" id="chaofan">
      <img src="chaofan.jpg" alt="Chaofan">
      <label for="chaofan">Chaofan</label>
      <span class="price">₱25.00</span>
      <div class="qty-box">
        <label>Qty:</label>
        <select><option>1</option><option>2</option><option>3</option></select>
      </div>
    </div>

<div class="food-item" data-category="meal">
      <input type="checkbox" id="hotdog">
      <img src="hotdog.jpg" alt="Hotdog">
      <label for="hotdog">Hotdog</label>
      <span class="price">₱20.00</span>
      <div class="qty-box">
        <label>Qty:</label>
        <select><option>1</option><option>2</option><option>3</option></select>
      </div>
    </div>

<div class="food-item" data-category="meal">
      <input type="checkbox" id="maling">
      <img src="maling.jpg" alt="Maling">
      <label for="maling">Maling</label>
      <span class="price">₱20.00</span>
      <div class="qty-box">
        <label>Qty:</label>
        <select><option>1</option><option>2</option><option>3</option></select>
      </div>
    </div>

<div class="food-item" data-category="meal">
      <input type="checkbox" id="Fried Egg">
      <img src="friedegg.jpg" alt="Fried Egg">
      <label for="friedegg">Fried Egg</label>
      <span class="price">₱15.00</span>
      <div class="qty-box">
        <label>Qty:</label>
        <select><option>1</option><option>2</option><option>3</option></select>
      </div>
    </div>

<div class="food-item" data-category="meal">
      <input type="checkbox" id="bacon">
      <img src="bacon.jpg" alt="Bacon">
      <label for="bacon">Bacon</label>
      <span class="price">₱20.00</span>
      <div class="qty-box">
        <label>Qty:</label>
        <select><option>1</option><option>2</option><option>3</option></select>
      </div>
    </div>

<div class="food-item" data-category="meal">
      <input type="checkbox" id="sinigang">
      <img src="sinigang.jpg" alt="Sinigang">
      <label for="sinigang">Sinigang</label>
      <span class="price">₱30.00</span>
      <div class="qty-box">
        <label>Qty:</label>
        <select><option>1</option><option>2</option><option>3</option></select>
      </div>
    </div>

<div class="food-item" data-category="meal">
      <input type="checkbox" id="mechado">
      <img src="mechado.jpg" alt="Mechado">
      <label for="mechado">Mechado</label>
      <span class="price">₱35.00</span>
      <div class="qty-box">
        <select><option>1</option><option>2</option><option>3</option></select>      
      </div>
    </div>

<div class="food-item" data-category="snack">
      <input type="checkbox" id="siopao">
      <img src="siapao.jpg" alt="Siopao">
      <label for="siopao">Siopao</label>
      <span class="price">₱30.00</span>
      <div class="qty-box">
        <label>Qty:</label>
        <select><option>1</option><option>2</option><option>3</option></select>
      </div>
    </div>

<div class="food-item" data-category="snack">
      <input type="checkbox" id="siomai">
      <img src="siomai.jpg" alt="Siomai">
      <label for="siomai">Siomai</label>
      <span class="price">₱20.00</span>
      <div class="qty-box">
        <label>Qty:</label>
        <select><option>1</option><option>2</option><option>3</option></select>
      </div>
    </div>

<div class="food-item" data-category="snack">
      <input type="checkbox" id="brownies">
      <img src="brownies.jpg" alt="Brownies">
      <label for="brownies">Brownies</label>
      <span class="price">₱35.00</span>
      <div class="qty-box">
        <label>Qty:</label>
        <select><option>1</option><option>2</option><option>3</option></select>
      </div>
    </div>
 
<div class="food-item" data-category="snack">
      <input type="checkbox" id="burger">
      <img src="burger.jpg" alt="Burger">
      <label for="burger">Burger</label>
      <span class="price">₱30.00</span>
      <div class="qty-box">
        <label>Qty:</label>
        <select><option>1</option><option>2</option><option>3</option></select>
      </div>
    </div>    

<div class="food-item" data-category="snack">
      <input type="checkbox" id="presto">
      <img src="presto.jpg" alt="Presto">
      <label for="presto">Presto</label>
      <span class="price">₱10.00</span>
      <div class="qty-box">
        <label>Qty:</label>
        <select><option>1</option><option>2</option><option>3</option></select>
      </div>
    </div>

<div class="food-item" data-category="snack">
      <input type="checkbox" id="oreo">
      <img src="oreo.jpg" alt="Oreo">
      <label for="oreo">Oreo</label>
      <span class="price">₱10.00</span>
      <div class="qty-box">
        <label>Qty:</label>
        <select><option>1</option><option>2</option><option>3</option></select>
      </div>
    </div>    

<div class="food-item" data-category="snack">
      <input type="checkbox" id="cheezy">
      <img src="cheezy.jpg" alt="Cheezy">
      <label for="cheezy">Cheezy</label>
      <span class="price">₱10.00</span>
      <div class="qty-box">
        <label>Qty:</label>
        <select><option>1</option><option>2</option><option>3</option></select>
      </div>
    </div>

<div class="food-item" data-category="snack">
      <input type="checkbox" id="cheezyspicy">
      <img src="cheezyspicy.jpg" alt="Cheezy Spicy">
      <label for="cheezyspicy">Cheezy Spicy</label>
      <span class="price">₱10.00</span>
      <div class="qty-box">
        <label>Qty:</label>
        <select><option>1</option><option>2</option><option>3</option></select>
      </div>
    </div>  

<div class="food-item" data-category="snack">
      <input type="checkbox" id="loaded">
      <img src="loaded.jpg" alt="Loaded">
      <label for="loaded">Loaded</label>
      <span class="price">₱10.00</span>
      <div class="qty-box">
        <label>Qty:</label>
        <select><option>1</option><option>2</option><option>3</option></select>
      </div>
    </div>

<div class="food-item" data-category="snack">
      <input type="checkbox" id="loadedwhite">
      <img src="loadedwhite.jpg" alt="Loaded White">
      <label for="loadedwhite">Loaded White</label>
      <span class="price">₱10.00</span>
      <div class="qty-box">
        <label>Qty:</label>
        <select><option>1</option><option>2</option><option>3</option></select>
      </div>
    </div>

<div class="food-item" data-category="snack">
      <input type="checkbox" id="piattoscheese">
      <img src="piattoscheese.jpg" alt="Piattos Cheese">
      <label for="piattoscheese">Piattos Cheese</label>
      <span class="price">₱20.00</span>
      <div class="qty-box">
        <label>Qty:</label>
        <select><option>1</option><option>2</option><option>3</option></select>
      </div>
    </div>

<div class="food-item" data-category="snack">
      <input type="checkbox" id="piattossnc">
      <img src="piattossnc.jpg" alt="Piattos Sour Cream and Onion">
      <label for="piattossnc">Piattos Sour Cream and Onion</label>
      <span class="price">₱20.00</span>
      <div class="qty-box">
        <label>Qty:</label>
        <select><option>1</option><option>2</option><option>3</option></select>
      </div>
    </div>

<div class="food-item" data-category="snack">
      <input type="checkbox" id="vcut">
      <img src="vcut.jpg" alt="V-Cut">
      <label for="vcut">V-Cut</label>
      <span class="price">₱20.00</span>
      <div class="qty-box">
        <label>Qty:</label>
        <select><option>1</option><option>2</option><option>3</option></select>
      </div>
    </div>

<div class="food-item" data-category="drink">
      <input type="checkbox" id="c2">
      <img src="c2.jpg" alt="C2">
      <label for="c2">C2</label>
      <span class="price">₱25.00</span>
      <div class="qty-box">
        <label>Qty:</label>
        <select><option>1</option><option>2</option><option>3</option></select>
      </div>
    </div>
    
<div class="food-item" data-category="drink">
      <input type="checkbox" id="water">
      <img src="water350.jpg" alt="Water 350 ML">
      <label for="water">Water 350 ML</label>
      <span class="price">₱10.00</span>
      <div class="qty-box">
        <label>Qty:</label>
        <select><option>1</option><option>2</option><option>3</option></select>
      </div>
    </div>

<div class="food-item" data-category="drink">
      <input type="checkbox" id="waterbig">
      <img src="waterbig.jpg" alt="Water 1000 ML">
      <label for="waterbig">Water 1000 ML</label>
      <span class="price">₱20.00</span>
      <div class="qty-box">
        <label>Qty:</label>
        <select><option>1</option><option>2</option><option>3</option></select>
      </div>
    </div>

<div class="food-item" data-category="drink">
      <input type="checkbox" id="mangoz">
      <img src="mangoz.jpg" alt="Zesto Big Mango">
      <label for="mangoz">Zesto Big Mango</label>
      <span class="price">₱25.00</span>
      <div class="qty-box">
        <label>Qty:</label>
        <select><option>1</option><option>2</option><option>3</option></select>
      </div>
    </div>

<div class="food-item" data-category="drink">
      <input type="checkbox" id="applez">
      <img src="applez.jpg" alt="Zesto Big Apple">
      <label for="applez">Zesto Big Apple</label>
      <span class="price">₱25.00</span>
      <div class="qty-box">
        <label>Qty:</label>
        <select><option>1</option><option>2</option><option>3</option></select>
      </div>
    </div>

<div class="food-item" data-category="drink">
      <input type="checkbox" id="orangez">
      <img src="orangez.jpg" alt="Zesto Big Orange">
      <label for="orangez">Zesto Big Orange</label>
      <span class="price">₱25.00</span>
      <div class="qty-box">
        <label>Qty:</label>
        <select><option>1</option><option>2</option><option>3</option></select>
      </div>
    </div>

<div class="food-item" data-category="drink">
      <input type="checkbox" id="chuckie">
      <img src="chuckie.jpg" alt="Chuckie">
      <label for="chuckie">Chuckie</label>
      <span class="price">₱20.00</span>
      <div class="qty-box">
        <label>Qty:</label>
        <select><option>1</option><option>2</option><option>3</option></select>
      </div>
    </div>

<div class="food-item" data-category="candy">
      <input type="checkbox" id="mentos">
      <img src="mentos.jpg" alt="Mentos">
      <label for="mentos">Mentos</label>
      <span class="price">₱2.00</span>
      <div class="qty-box">
        <label>Qty:</label>
        <select><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
      </div>
    </div>

<div class="food-item" data-category="candy">
      <input type="checkbox" id="maxxred">
      <img src="maxxred.jpg" alt="Maxx Cherry">
      <label for="maxxred">Maxx Cherry</label>
      <span class="price">₱2.00</span>
      <div class="qty-box">
        <label>Qty:</label>
        <select><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
      </div>
    </div>

<div class="food-item" data-category="candy">
      <input type="checkbox" id="maxxyellow">
      <img src="maxxyellow.jpg" alt="Maxx Lemon">
      <label for="maxxyellow">Maxx Lemon</label>
      <span class="price">₱2.00</span>
      <div class="qty-box">
        <label>Qty:</label>
        <select><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
      </div>
    </div>

<div class="food-item" data-category="candy">
      <input type="checkbox" id="maxxorange">
      <img src="maxxorange.jpg" alt="Maxx Orange">
      <label for="maxxorange">Maxx Orange</label>
      <span class="price">₱2.00</span>
      <div class="qty-box">
        <label>Qty:</label>
        <select><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
      </div>
    </div>

<div class="food-item" data-category="candy">
      <input type="checkbox" id="frooty">
      <img src="frooty.jpg" alt="Frooty Lollipops">
      <label for="frooty">Frooty Lollipops</label>
      <span class="price">₱5.00</span>
      <div class="qty-box">
        <label>Qty:</label>
        <select><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
      </div>
    </div>

<div class="food-item" data-category="candy">
      <input type="checkbox" id="choko">
      <img src="choko.jpg" alt="Choko-Choko">
      <label for="choko">Choko-Choko</label>
      <span class="price">₱2.00</span>
      <div class="qty-box">
        <label>Qty:</label>
        <select><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
      </div>
    </div>

<div class="food-item" data-category="candy">
      <input type="checkbox" id="vfresh">
      <img src="vfresh.jpg" alt="VFresh">
      <label for="vfresh">VFresh</label>
      <span class="price">₱3.00</span>
      <div class="qty-box">
        <label>Qty:</label>
        <select><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
      </div>
    </div>

    <div class="summary-container">
  <h3>Order Summary</h3>
  <div id="summary-list">
    </div>
  
  <div class="payment-section">
    <div class="total-row">
      <span>Total Amount:</span>
      <span id="total-price">₱0.00</span>
    </div>

  <div class="payment-section">
  <h3>Mode of Payment</h3>

  <label class="payment-option">
    <input type="radio" name="pay" value="cash" checked> Cash
  </label>

<div class="online-payment-container">
  <input type="radio" name="pay" value="online" id="online-trigger"> 
  <label for="online-trigger" class="payment-label">Online Payment</label>

  <div class="online-options">
    <label class="online-item">
      <input type="radio" name="sub-pay" value="gcash"> 
      <img src="gcash.jpg" alt="GCash"> GCash
    </label>
    <label class="online-item">
      <input type="radio" name="sub-pay" value="maya"> 
      <img src="maya.jpg" alt="Maya"> Maya
    </label>
  </div>
    <div class="payment-number">
      <label class="payment-label" for="payment-id">Enter GCash/Maya Number:</label>
      <input type="text" id="payment-id" name="payment-id" placeholder="09XXXXXXXXX" style="width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #ccc; border-radius: 4px;">
    </div>
</div>    


<div class="service-selection">
      <label>Service Time:</label>
      <select name="service_time">
        <option value="Recess">Recess</option>
        <option value="Lunch">Lunch</option>
      </select>
    </div>

</div>

    <button type="submit" class="checkout-btn">PROCEED TO PAY</button>
  </div>
  </form>
</div>

<script>
window.onload = function() {
    // 1. GATEKEEPER & NAME DISPLAY
    const name = localStorage.getItem("studentName");
    if (!localStorage.getItem("isLoggedIn")) {
        window.location.href = "login.html";
        return;
    }
    document.getElementById("display-name").innerText = name || "Student";

    sessionStorage.removeItem("adminAuthenticated");

    // 2. RESTORE PRICE CALCULATOR
    const form = document.querySelector('form');
    const summaryList = document.getElementById('summary-list');
    const totalPriceDisplay = document.getElementById('total-price');

    form.addEventListener('input', () => {
        let total = 0;
        summaryList.innerHTML = "";
        
        document.querySelectorAll('.food-item').forEach(item => {
            const checkbox = item.querySelector('input[type="checkbox"]');
            const select = item.querySelector('select');
            
            if (checkbox && checkbox.checked) {
                const foodName = item.querySelector('label').innerText;
                const priceText = item.querySelector('.price').innerText;
                const price = parseFloat(priceText.replace('₱', ''));
                const qty = parseInt(select.value);
                const itemTotal = price * qty;
                
                total += itemTotal;

                // Update the summary list
                summaryList.innerHTML += `
                    <p style="font-size:14px; margin:5px 0;">
                        • ${foodName} x${qty} 
                        <span style="float:right;">₱${itemTotal.toFixed(2)}</span>
                    </p>`;
            }
        });
        totalPriceDisplay.innerText = `₱${total.toFixed(2)}`;
    });

    // 3. SAVE DATA ON SUBMIT
    form.addEventListener('submit', (e) => {
        let orderedItems = [];
        document.querySelectorAll('.food-item').forEach(item => {
            const checkbox = item.querySelector('input[type="checkbox"]');
            if (checkbox && checkbox.checked) {
                orderedItems.push({
                    name: item.querySelector('label').innerText,
                    qty: item.querySelector('select').value,
                    price: item.querySelector('.price').innerText
                });
            }
        });
        
        if (orderedItems.length === 0) {
            e.preventDefault();
            alert("Please select at least one item!");
            return;
        }

        localStorage.setItem("latestOrder", JSON.stringify(orderedItems));
        localStorage.setItem("latestTotal", totalPriceDisplay.innerText);
    });
};

// 4. CATEGORY FILTER (Fixes the layout "mess")
function filterCategory(category, btn) {
    document.querySelectorAll('.cat-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');

    const items = document.querySelectorAll('.food-item');
    items.forEach(item => {
        if (category === 'all' || item.getAttribute('data-category') === category) {
            item.style.display = 'flex'; // Use flex to keep images and labels aligned
        } else {
            item.style.display = 'none';
        }
    });
}

function logout() {
    localStorage.clear();
    window.location.href = "login.html";
}

// Function to show/hide the online payment fields
function togglePaymentForm(show) {
    const details = document.getElementById('online-details');
    details.style.display = show ? 'block' : 'none';
}

// Update your existing Form Submit Listener
const orderForm = document.querySelector('form');
orderForm.addEventListener('submit', (e) => {
    const isOnline = document.getElementById('pay_online').checked;
    const refNum = document.getElementById('ref_number').value;
    const accName = document.getElementById('account_name').value;
    
    // 1. Check if food is selected (your existing check)
    let orderedItems = [];
    document.querySelectorAll('.food-item').forEach(item => {
        const checkbox = item.querySelector('input[type="checkbox"]');
        if (checkbox && checkbox.checked) {
            orderedItems.push({
                name: item.querySelector('label').innerText,
                qty: item.querySelector('select').value,
                price: item.querySelector('.price').innerText
            });
        }
    });

    if (orderedItems.length === 0) {
        e.preventDefault();
        alert("Please select at least one item!");
        return;
    }

    // 2. NEW: Payment Validation
    if (isOnline) {
        if (!refNum || !accName) {
            e.preventDefault(); // Stop checkout
            alert("Please fill in your Online Payment details (Reference Number & Name)!");
            return;
        }
        // Save payment info to storage if valid
        localStorage.setItem("paymentDetails", `Ref: ${refNum} | Name: ${accName}`);
    } else {
        localStorage.setItem("paymentDetails", "Paid via Cash");
    }

    // 3. Save Order and Continue
    localStorage.setItem("latestOrder", JSON.stringify(orderedItems));
    localStorage.setItem("latestTotal", document.getElementById('total-price').innerText);
    localStorage.setItem("paymentMethod", isOnline ? "Online" : "Cash");
});
</script>
</body>
<footer style="text-align: center; padding: 20px; opacity: 0.5;">
  <a href="admin.html" style="font-size: 10px; color: #666; text-decoration: none;">Admin Login</a>
</footer>
</html>